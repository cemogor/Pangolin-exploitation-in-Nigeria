rm(list=ls())


# LOAD PACKAGES -----------------------------------------------------------
library(dplyr)
library(reshape)
library(ggplot2)
library(ggpubr)
library(lubridate)
library(zoo)
library(arsenal)
library(tidyverse)
library(data.table)
library(lme4)                            #Provides functions for fitting and analyzing mixed models
library(performance)                     #Inspect model performance (more: https://easystats.github.io/see/articles/perainfallormance.html)
library(see)                             #Visualize figures from 'perainfallormance' package
library(patchwork)                       #Visualize figures from 'perainfallormance' package
library(DescTools)                       #Calculate Gini coefficient 
library(gglorenz)                        #Calculate Gini coefficient and make Lorenz plot
library(viridis)                         #Beautiful plot color combo
library(rcartocolor)
library(ggsci)                           #Publication-worthy plots
library(car)                             #To run Levene's test for equality of variance 
library(wesanderson)                     #Additional color palettes 
library(GGally)                          #Correlation plots
library(MuMIn)                           #Model validation 
library(lm.beta)                         #Checking beta coefficients 
library(confidence)                      #Data back-transformations
library(lattice)                         #Needed for multi-panel graphs
library(MASS)                            #Negative binomial models
library(rphylopic)                       #Insert silhouette figures from phylopic.org
library(gridExtra)                       #Creating multi-panel plots (more: https://cran.r-project.org/web/packages/egg/vignettes/Ecosystem.html)
library(REAT)                            #Another gini coef function(more: https://github.com/jjchern/gglorenz)
library(DHARMa)                          #Plot residuals for GLMMM
library(AICcmodavg)
library(tidyr)
library(ggeffects)
library(tibble)
library(glmmTMB)
library(bbmle)
library(car)
library(ggpubr)
library(lmerTest)
library(emmeans)
library(broom)
library(modelsummary)
library(effects)
library(jtools)
library(blueycolors)


################################################################################
################################################################################
################################################################################
###############                                                #################
###############   CHANGES IN PRICE OF PANGOLIN MEAT & SCALES   #################
###############                                                #################
################################################################################
################################################################################
################################################################################


pang.price <- read.csv("09.pangolin.price.csv")

#NOTE: Data set contains prices for pangolin scales and meat over time. 

length(unique(pang.price$id)) #Number of unique responses.

str(pang.price) #Check variable format


# Reformat certain variables ----------------------------------------------


pang.price <- pang.price %>% 
  mutate(part = as.factor(part),
         species = as.factor(species),
         price.adjusted = as.numeric(price.adjusted),
         location = as.factor(location),
         household.id = as.factor(household.id ),
         respondent.id = as.factor(respondent.id),
         respondent.type = as.factor(respondent.type),
         log.price.adjusted = log(price.adjusted),
         period2 = factor(period, levels = c("Jan 2010-Dec 2015", "Jan 2016-Feb 2020", "April-Sept 2020 (COVID lockdown)", "Oct 2020-Sept 2023"))) 

pang.price <- pang.price %>% 
  mutate(period = factor(case_when(period2 == "Jan 2010-Dec 2015" ~ "P1",
                             period2 == "Jan 2016-Feb 2020" ~ "P2",
                             period2 == "April-Sept 2020 (COVID lockdown)" ~ "P3",
                             period2 == "Oct 2020-Sept 2023" ~ "P4"))) 

str(pang.price)


# VISUALISE THE DATA ------------------------------------------------------

boxplot(pang.price$price.adjusted ~ pang.price$part* pang.price$species)
boxplot(pang.price$price.adjusted ~ pang.price$species)
boxplot(pang.price$price.adjusted ~ pang.price$period)
boxplot(pang.price$price.adjusted ~ pang.price$respondent.type)
boxplot(price.adjusted ~ part * period, data = pang.price)
boxplot(price ~ part * period, data = pang.price)

hist(pang.price$price.adjusted)
hist(pang.price$log.price.adjusted) #Log-transform response variable


# UNIVARIATE PLOT ---------------------------------------------------------

supp.part <- ggplot(pang.price %>% filter(unique.id != 8921), aes(period, price.adjusted, fill = part)) +
  geom_boxplot(position = position_dodge(width = 0.8),color="black", size = .5, alpha = .8, outlier.size = 3, outlier.fill = "grey", outlier.alpha = .4) +
  labs(x = "Period", y = "Real price (Naira)", fill = " ") +
  theme_pubr(base_size = 14) +
  facet_wrap(~species, scales = "free_x", labeller = labeller(species = c("BBP" = "Black-bellied pangolin", "WBP" = "White-bellied pangolin"))) +
  theme(axis.title = element_text(size = 19),
        legend.text = element_text(size = 17), 
        strip.text = element_text(color = "black", size = 15),
        strip.background = element_rect(fill = "white", color = "black", linetype = "solid")) +
  scale_x_discrete(labels = c("P1" = " 2010-\n2015", 
                              "P2" = " 2016-\n2020", 
                              "P3" = "COVID-19\nlockdown", 
                              "P4" = "Post-\nlockdown")) +
  scale_fill_aaas() +
  scale_fill_manual(values = c("Meat" = "#025464", "Scale" = "#8C3333"),
                    label = c("Meat" = "Meat", "Scale" = "Scales")) 


supp.part

supp.respondent <- ggplot(pang.price %>% filter(unique.id != 8921), aes(respondent.type, price.adjusted, fill = part)) +
  geom_boxplot(position = position_dodge(width = 0.8),color="black", size = .5, alpha = .8, outlier.size = 3, outlier.fill = "grey", outlier.alpha = .4) +
  labs(x = "Period", y = "Real price (Naira)", fill = " ") +
  facet_wrap(~species, scales = "free_x", labeller = labeller(species = c("BBP" = "Black-bellied pangolin", "WBP" = "White-bellied pangolin"))) +
  theme_pubr(base_size = 14) +
  theme(axis.title = element_text(size = 19),
        legend.text = element_text(size = 17), 
        strip.text = element_text(color = "black", size = 15),
        strip.background = element_rect(fill = "white", color = "black", linetype = "solid")) +
  scale_x_discrete(labels = c("P1" = "2010-\n2015", 
                              "P2" = "2016-\n2020", 
                              "P3" = "COVID-19\nlockdown", 
                              "P4" = "Post\n-lockdown")) +
  scale_fill_aaas() +
  scale_fill_manual(values = c("Meat" = "#025464", "Scale" = "#8C3333"),
                    label = c("Meat" = "Meat", "Scale" = "Scales")) +
  scale_x_discrete(labels = c("Hunter" = "Hunter", "Market" = "Vendor"))

supp.respondent

supp.f1 <- ggarrange(supp.respondent, supp.part,
                         labels = c("A", "B"),
                         ncol = 1,
                     common.legend = T,
                         font.label = list(size = 24))


supp.f1

ggsave("figS6.tiff",
       supp.f1, 
       path = "Figure",
       height = 20,
       width = 22,
       units = "cm",
       dpi = 300)


# RUN MODEL ---------------------------------------------------------------

#Interaction between period and part
pang.price.model1 <- lmer(log.price.adjusted ~ period * part + species + respondent.type + (1|location) + (1|household.id/respondent.id), data = pang.price)

#Additive model
pang.price.model2 <- lmer(log.price.adjusted ~ period + part + species + respondent.type + (1|location) + (1|household.id/respondent.id), data = pang.price)

#Compare models
plot(compare_performance(pang.price.model1, pang.price.model2))

#Select  most parsimonious model (using AIC and AICwt)
pang.price.model <- pang.price.model1


# MODEL DIAGNOSTICS -------------------------------------------------------
tiff(filename = "Figure/figS8.tiff", width = 30, height = 37, units = "cm", res = 600)
check_model(pang.price.model) #Model fit
dev.off()

check_convergence(pang.price.model)
check_singularity(pang.price.model)
check_collinearity(pang.price.model)
check_outliers(pang.price.model)

r2(pang.price.model) #Variance explained 

# MODEL SUMMARY -----------------------------------------------------------

summary(pang.price.model)


# POSTHOC TEST ------------------------------------------------------------
emm_options(pbkrtest.limit = 3960)

posthoc.pang.price.model <- emmeans(pang.price.model, ~ part |period) #Compare the effect of pangolin part separately for each period.
posthoc.pang.price.model2 <- emmeans(pang.price.model, ~ period |part) #Compare the effect of period separately for pangolin part.

pairs(posthoc.pang.price.model, adjust="BH") #BH is best for controlling for false discovery rate (given multiple testing)
pairs(posthoc.pang.price.model2, adjust="BH") 

plot(pairs(posthoc.pang.price.model2), comparisons = TRUE)


# PLOT MODEL --------------------------------------------------------------

plot(ggpredict(pang.price.model, "species", back.transform = TRUE, type = "fixed")) +
  theme_pubr()

plot(ggpredict(pang.price.model, c("period"), back.transform = TRUE, type = "fixed")) +
  theme_pubr()

plot(ggpredict(pang.price.model, c("period", "part"), back.transform = TRUE, type = "fixed")) +
  theme_pubr(base_size = 15) 



# EFFECTS PLOT ------------------------------------------------------------

effect.plot <- plot_summs(pang.price.model, robust = TRUE, 
           colors = "#132043", point.shape = TRUE,
           point.size = 2) +
  theme_pubr(base_size = 8) +
  theme(
    axis.text = element_text(size = 7),
    axis.title.x = element_text(vjust = .1, size = 10),
    axis.title.y = element_text(vjust = 2, size = 10)) +
  labs(x ="Standardised coefficient", y= "Term") +
  scale_y_discrete(labels = c("periodP2"= "2016-2020", 
                              "periodP3" ="COVID-19 lockdown",
                              "periodP4"= "Oct 2020-Sept 2023",
                              "partScale" = "Scale",
                              "speciesWBP" = "White-bellied pangolin",
                              "respondent.typeMarket" = "Vendor", 
                              "periodP2:partScale" = "2016-2020:Scale",
                              "periodP3:partScale" = "COVID-19 lockdown:Scale",
                              "periodP4:partScale" = "Post-lockdown:Scale")) 
effect.plot
  

# PERIOD AND PART ---------------------------------------------------------

model.predicted.interaction <- ggpredict(pang.price.model, c("period", "part"), back.transform = TRUE, type = "fixed")

model.predicted.interaction <- model.predicted.interaction %>% 
  mutate(
    conf.high = exp(conf.high),
    conf.low = exp(conf.low),
    predicted = exp(predicted),
    std.error = exp(std.error),
    group = ifelse(group == "Scale", "Scales", "Meat"))

pang.price1 <- pang.price %>% 
  mutate(part = ifelse(part == "Scale", "Scales", "Meat"))


interaction.plot <- ggplot()+
  geom_point(data = model.predicted.interaction, aes(x=x,y=predicted, col = factor(group)), size = 3) +
  geom_errorbar(data=model.predicted.interaction, aes(x=x,y=predicted, ymin = conf.low, ymax = conf.high, col = factor(group)), width =.1, size =1) +
  theme_pubr(base_size = 13) + 
  theme(
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    axis.text.x = element_text(size = 13),
    axis.title = element_text(size = 17),
    legend.text=element_text(size=16),
    legend.position = "top",
    legend.justification = c(0.2),
    legend.title = element_blank()) +
  labs(x ="Period", y= "Price/animal (NGN)") +
  scale_colour_manual(values = c("#025464", "#8C3333")) +
  scale_fill_manual(values = c("#025464", "#8C3333")) +
  scale_x_discrete(labels = c("P1"=" 2010-\n2015", "P2"=" 2016-\n2020", "P3" ="COVID-19\nlockdown","P4"= "Post-\nlockdown")) +
  scale_y_continuous(labels = scales::comma)


interaction.plot


################################################################################
################################################################################
################################################################################
###############                                                #################
###############        CHANGES IN PRICES OF OTHER SPECIES      #################
###############                                                #################
################################################################################
################################################################################
################################################################################


species.price <- read.csv("10.other.species.price.csv")

length(unique(species.price$id))

#Number of response per person
species.price %>% 
  group_by(id) %>% 
  summarise(number = n())

#Variable format
str(species.price)

#Reformat certain variables
species.price <- species.price %>% 
  mutate(part = as.factor(part),
         species = as.factor(species),
         price.adjusted = as.numeric(price.adjusted),
         location = as.factor(location),
         household.id = as.factor(household.id ),
         respondent.id = as.factor(respondent.id),
         respondent.type = as.factor(respondent.type),
         log.price.adjusted = log(price.adjusted),
         period2 = factor(period, levels = c("Jan 2010-Dec 2015", "Jan 2016-Feb 2020", "April-Sept 2020 (COVID lockdown)", "Oct 2020-Sept 2023")))

species.price <- species.price %>% 
  mutate(period = factor(case_when(period2 == "Jan 2010-Dec 2015" ~ "P1",
                                   period2 == "Jan 2016-Feb 2020" ~ "P2",
                                   period2 == "April-Sept 2020 (COVID lockdown)" ~ "P3",
                                   period2 == "Oct 2020-Sept 2023" ~ "P4"))) 
str(species.price)


# VISUALISE THE DATA ------------------------------------------------------

boxplot(species.price$price.adjusted ~ species.price$species)
boxplot(species.price$price.adjusted ~ species.price$period)
boxplot(species.price$price.adjusted ~ species.price$respondent.type)
boxplot(price.adjusted ~ species * period, data = species.price)

hist(species.price$price.adjusted)
hist(species.price$log.price.adjusted) #Log-transform response variable


# UNIVARIATE PLOT ---------------------------------------------------------

species.price <- species.price %>% 
  mutate(species = factor(species, levels = c("Porcupine",
                                              "Blue duiker",
                                              "Red river hog",
                                              "White-bellied pangolin", 
                                              "Black-bellied pangolin"))) %>% 
  mutate(species = case_when(species == "Porcupine" ~ "African brush-tailed porcupine", 
                             species == "Blue duiker" ~ "Blue duiker",
                             species == "Red river hog" ~ "Red river hog",
                             species ==  "White-bellied pangolin" ~  "White-bellied pangolin",
                             species == "Black-bellied pangolin" ~ "Black-bellied pangolin"))

supp.species <- ggplot(species.price %>% filter(unique.id != 11013) %>%  filter(!species %in% c("White-bellied pangolin", "Black-bellied pangolin")), aes(period, price.adjusted, col = species)) +
  geom_boxplot(position = position_dodge(width = 0.8), size = .3, alpha = .8, outlier.size = 3, outlier.fill = "grey", outlier.alpha = .4) +
  labs(x = "Period", y = "Real price (Naira)", col = " ") +
  theme_pubr(base_size = 11) +
  theme(axis.title = element_text(size = 15),
        legend.text = element_text(size = 12),
        legend.spacing = unit(1, "cm"),  # Add spacing between legend items
        legend.position = "right",
        strip.text = element_text(color = "black", size = 11)) +
  scale_x_discrete(labels = c("P1" = " 2010-\n2015", 
                              "P2" = " 2016-\n2020", 
                              "P3" = "COVID-19\nlockdown", 
                              "P4" = "Post-\nlockdown")) +
  scale_colour_manual(values = c("#FFBB64", "#3EC70B", "#6C22A6"),
                      labels = c("African brush-\ntailed porcupine", "Blue duiker", "Red river hog")) +
  scale_y_continuous(labels = scales::number_format(scale = 1e-3, suffix = "k"))  # Adjust the scale factor as needed


supp.species


supp.respondent.all <- ggplot(species.price %>% filter(unique.id != 11013) %>%  filter(!species %in% c("White-bellied pangolin", "Black-bellied pangolin")), aes(species, price.adjusted, col = respondent.type)) +
  geom_boxplot(position = position_dodge(width = 0.8), size = .3, alpha = .8, outlier.size = 3, outlier.fill = "grey", outlier.alpha = .4) +
  labs(x = "Species", y = "Real price (Naira)", col = " ") +
  theme_pubr(base_size = 11) +
  theme(axis.title = element_text(size = 15),
        legend.text = element_text(size = 12),
        legend.position = "right") +
  scale_x_discrete(labels = c("African brush-tailed porcupine" = "African brush-\ntailed porcupine",
                              "Blue duiker" = "Blue \nduiker", 
                              "Red river hog" = "Red\n river hog")) + 
  scale_color_npg() +
  scale_y_continuous(labels = scales::number_format(scale = 1e-3, suffix = "k"))

supp.respondent.all

supp.f2 <- ggarrange(supp.species, supp.respondent.all,
                     labels = c("a", "b"),
                     nrow = 2,
                     align = "hv",
                     font.label = list(size = 18.5))


supp.f2

ggsave("figS7.tiff",
       supp.f2, 
       path = "Figure",
       height = 20,
       width = 16,
       units = "cm",
       dpi = 300)


# RUN MODEL ---------------------------------------------------------------

length(unique(species.price$respondent.id))          

species.price.model <- lmer(log.price.adjusted ~ period + species + respondent.type + (1|location) + (1|household.id/respondent.id), data = species.price)

# MODEL DIAGNOSTICS -------------------------------------------------------

tiff(filename = "Figure/figS9.tiff", width = 30, height = 37, units = "cm", res = 600)
check_model(species.price.model) #Model fit
dev.off()

check_convergence(species.price.model)
check_singularity(species.price.model)
check_collinearity(species.price.model)
check_outliers(species.price.model)


# MODEL SUMMARY -----------------------------------------------------------

summary(species.price.model)

r2(species.price.model) #Variance explained 

# POSTHOC TEST ------------------------------------------------------------

emm_options(pbkrtest.limit = 7916)
posthoc.species.price.model <- emmeans(species.price.model, ~ period) 
posthoc.species.price.model2 <- emmeans(species.price.model, ~ species)

pairs(posthoc.species.price.model, adjust="BH") 
pairs(posthoc.species.price.model2, adjust="BH")

coef.species.ph.period <- as.data.frame(summary(species.price.model)$coefficients)

# PLOT MODEL --------------------------------------------------------------

plot(ggpredict(species.price.model, "period", back.transform = TRUE, type = "fixed")) +
  theme_pubr()

plot(ggpredict(species.price.model, "species", back.transform = TRUE, type = "fixed")) +
  theme_pubr()


# EFFECTS PLOT ------------------------------------------------------------

effect.plot.species <- plot_summs(species.price.model, robust = TRUE, inner_ci_level = .9,
                          colors = "#FD841F", point.shape = TRUE,
                          point.size = 4) +
  theme_pubr(base_size = 15) +
  theme(
    axis.text.y = element_text(size = 13),
    axis.title.x = element_text(vjust = -.3, size = 20),
    axis.title.y = element_text(vjust = 2, size = 20)) +
  labs(x ="Estimate", y= "Term") +
  scale_y_discrete(labels = c("periodP2"= "2016-2020", 
                              "periodP3" ="April-Sept 2020 (COVID lockdown)",
                              "periodP4"= "Oct 2020-Sept 2023",
                              "speciesBlue duiker" = "Blue duiker",
                              "respondent.typeMarket" = "Vendor", 
                              "speciesPorcupine" = "African brush-tail porcupine",
                              "speciesRed river hog" = "Red river hog")) 



effect.plot.species

# SPECIES ---------------------------------------------------------

model.predicted.species <- ggpredict(species.price.model, c("species"), back.transform = TRUE, type = "fixed")
model.predicted.species <- model.predicted.species %>% 
  mutate(
    conf.high = exp(conf.high),
    conf.low = exp(conf.low),
    predicted = exp(predicted),
    std.error = exp(std.error))


species.period.plot <- ggplot()+
  geom_point(data = model.predicted.species, aes(x=x,y=predicted,  col = factor(group)), size = 3) +
  geom_errorbar(data=model.predicted.species, aes(x=x,y=predicted, ymin = conf.low, ymax = conf.high,  col = factor(group)), width =.1, size =1) +
  theme_pubr(base_size = 12) + 
  theme(
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    axis.text.x = element_text(size = 14),
    axis.title.x = element_text(vjust = -.3, size = 15),
    axis.title.y = element_text(vjust = 2, size = 15),
    legend.text=element_text(size=15),
    legend.position = "top",
    legend.title = element_blank()) +
  labs(x ="", y= "Price (NGN)") +
  scale_x_discrete(labels = c("Blue duiker" = "Blue duiker","Porcupine" = "African brush-tail\n porcupine", "Red river hog" = "Red river hog"))

species.period.plot



# DUIKER ------------------------------------------------------------------

model.predicted.period <- ggpredict(species.price.model, c("period", "species"), back.transform = TRUE, type = "fixed")

model.predicted.period <- model.predicted.period %>% 
  mutate(
    conf.high = exp(conf.high),
    conf.low = exp(conf.low),
    predicted = exp(predicted),
    std.error = exp(std.error))

ppkg.duiker <- model.predicted.period %>% 
  filter (group == "Blue duiker") %>% 
  mutate(median.mass = 5,
         ppkg = predicted/5) 


duiker <- ggplot()+ 
  geom_point(data = model.predicted.period %>% filter (group == "Blue duiker"), aes(x=x,y=predicted,  col = "black"), size = 3) +
  geom_errorbar(data=model.predicted.period %>% filter (group == "Blue duiker"), aes(x=x,y=predicted, ymin = conf.low, ymax = conf.high,  col = "black"), width =.1, size =1) +
  theme_pubr(base_size = 13) +
  theme(
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    axis.text.x = element_text(size = 14),
    axis.title = element_text(size = 17),
    legend.text=element_text(size=14),
    legend.justification = c(0.2,1),
    legend.position = "top",
    legend.title = element_blank()) +
  labs(x ="Period", y= "Price/animal (NGN)") +
  scale_colour_manual(values = c("#025464"), labels = c("Meat")) +
  scale_x_discrete(labels = c("P1"=" 2010-\n2015", "P2"=" 2016-\n2020", "P3" ="COVID-19\nlockdown","P4"= "Post-\nlockdown")) +
  scale_y_continuous(labels = scales::comma)

duiker


# PORCUPINE ---------------------------------------------------------------

porc <- ggplot()+ 
  geom_point(data = model.predicted.period %>% filter (group == "African brush-tailed porcupine"), aes(x=x,y=predicted,  col = "black"), size = 3) +
  geom_errorbar(data=model.predicted.period %>% filter (group == "African brush-tailed porcupine"), aes(x=x,y=predicted, ymin = conf.low, ymax = conf.high,  col = "black"), width =.1, size =1) +
  theme_pubr(base_size = 13) +
  theme(
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    axis.text.x = element_text(size = 14),
    axis.title = element_text(size = 17),
    axis.title.x = element_text(vjust = -.3, size = 17),
    axis.title.y = element_text(vjust = 2, size = 17),
    legend.text=element_text(size=14),
    legend.justification = c(0.2,1),
    legend.position = "top",
    legend.title = element_blank()) +
  labs(x ="Period", y= "Price/animal (NGN)") +
  scale_colour_manual(values = c("#025464"), labels = c("Meat")) +
  scale_x_discrete(labels = c("P1"=" 2010-\n2015", "P2"=" 2016-\n2020", "P3" ="COVID-19\nlockdown","P4"= "Post-\nlockdown")) +
  scale_y_continuous(labels = scales::comma)

porc


# RED RIVER HOG -----------------------------------------------------------
 
rrh <- ggplot()+ 
  geom_point(data = model.predicted.period %>% filter (group == "Red river hog"), aes(x=x,y=predicted,  col = "black"), size = 3) +
  geom_errorbar(data=model.predicted.period %>% filter (group == "Red river hog"), aes(x=x,y=predicted, ymin = conf.low, ymax = conf.high,  col = "black"), width =.1, size =1) +
  theme_pubr(base_size = 13) +
  theme(
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    axis.text.x = element_text(size = 14),
    axis.title = element_text(size = 17),
    legend.text=element_text(size=14),
    legend.justification = c(0.2,1),
    legend.position = "top",
    legend.title = element_blank()) +
  labs(x ="Period", y= "Price/animal (NGN)") +
  scale_colour_manual(values = c("#025464"), labels = c("Meat")) +
  scale_x_discrete(labels = c("P1"=" 2010-\n2015", "P2"=" 2016-\n2020", "P3" ="COVID-19\nlockdown","P4"= "Post-\nlockdown")) +
  scale_y_continuous(labels = scales::comma)

rrh


# All species -------------------------------------------------------------

species.plot <- ggplot()+
  geom_point(data = model.predicted.period, aes(x=x,y=predicted,  col = "black"), size = 3) +
  geom_errorbar(data=model.predicted.period, aes(x=x,y=predicted, ymin = conf.low, ymax = conf.high,  col = "black"), width =.1, size =1) +
  theme_pubr(base_size = 13) + 
  theme(
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    axis.text.x = element_text(size = 14),
    axis.title = element_text(size = 18),
    legend.text=element_text(size=14),
    legend.justification = c(0.2,1),
    legend.position = "top",
    legend.title = element_blank()) +
  labs(x =" ", y= "") +
  scale_colour_manual(values = c("#025464"), labels = c("Meat")) +
  scale_x_discrete(labels = c("P1"=" 2010-\n2015", "P2"=" 2016-\n2020", "P3" ="COVID-19\nlockdown","P4"= "Post-\nlockdown")) 

species.plot

################################################################################
################################################################################
################################################################################
###############                                                #################
###############                 SAVE PLOT                      #################
###############                                                #################
################################################################################
################################################################################
################################################################################


model.plots <- ggarrange(interaction.plot, porc,
                         duiker, rrh,
                         labels = "AUTO",
                         align = "hv",
                         nrow = 2,
                         ncol = 2,
                         heights = c(1,1),
                         common.legend = T,
                         legend = "top",
                         font.label = list(size = 22))


ggsave("fig3.tiff",
       model.plots, 
       path = "Figure",
       height = 20,
       width = 25,
       units = "cm",
       dpi = 300)